#!/usr/bin/env node

/*
 * require modules
 */
var cmd = require('commander');
var lib = require('../lib');
var package = require('../package.json');

var log = lib.log;
var search = lib.search;
var prepare = lib.prepare;
var doctor = lib.doctor;
var update = lib.update;
  
cmd.version(package.version)
  .option('-s, --search <system>',
	  'search systems',
	  search)
  .option('-p, --prepare <program>',
	  "install 'sbcl', 'quicklisp' or 'qlot'",
	  prepare)
  .option('-d, --doctor',
	  '',
	  doctor)
  .option('-u, --update <command>',
	  "update 'client' or 'dist'",
	  update)
  .parse(process.argv);

if (process.argv.length === 2) {
  // case: no arguments. print help and exit
  cmd.help();
}


if (cmd.args.length >= 1) {
  // case: no option specified. search all packages in args
  cmd.args.forEach(search);
}


// handle exceptions
process.on('uncaughtException', function(err) {
  log.error("uncaughtException ", err);
});

